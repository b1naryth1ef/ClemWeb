
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Clementine Web Player</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <link href="/static/css/style.css" rel="stylesheet">
    <style type="text/css">
      body {
        padding-top: 20px;
        padding-bottom: 40px;
      }
      .container-narrow {
        margin: 0 auto;
        max-width: 900px;
      }
      .container-narrow > hr {
        margin: 30px 0;
      }
      .jumbotron {
        margin: 60px 0;
        /*text-align: center;*/
      }
      .jumbotron h1 {
        font-size: 72px;
        line-height: 1;
      }
      .jumbotron .btn {
        font-size: 21px;
        padding: 14px 24px;
      }
      .marketing {
        margin: 60px 0;
      }
      .marketing p + h4 {
        margin-top: 28px;
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container-narrow">
      <div class="masthead">
        <h3 class="muted">Clementine Web Player</h3>
      </div>

      <hr>

      <div class="row-fluid jumbotron">
        <div class="span3">
          <p><img src="/getimage" class="img-polaroid" height="150" width="150" id="art" style="margin-top: 20px"></p>
        </div>
        <div class="span9">
          <h3>
            <span class="label label-large label-warning play">Paused</span>
            <span class="label label-large label-success pause">Playing</span>
            <span id="title">{{ song['title'] }}</span> -- <span id="artist">{{ song['artist'] }}</span>
          </h3>
          <p class="lead">
            <b>Album: </b><span class="upd" id="album"></span><br />
            <b>Duration: </b><span class="upd" id="time"></span><br />
            <b>Year: </b><span class="upd" id="year"></span><br />
          </p>
            <hr>
          <div class="progress">
            <div class="bar" style="width: 60%;"></div>
          </div>
          <div style="text-align: center">
            <a class="btn btn-large btn-info click" act="last">< Last</a>
            <a class="btn btn-large btn-warning pause click" act="pause">Pause</a>
            <a class="btn btn-large btn-success play click" act="play">Play</a> 
            <a class="btn btn-large btn-info click" act="next">Next ></a>
          </div>
        </div>
      </div>
      <hr>
      <div class="footer">
        <p>&copy; B1naryTh1ef 2012</p>
      </div>

    </div> <!-- /container -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="/static/js/bootstrap.js"></script>
    <script>
      $(document).ready(function(){
        $('.click').click(function(){
          ws.send($(this).attr('act'))
        })

        if ("WebSocket" in window) {                                         
          ws = new WebSocket("ws://" + document.domain + ":5000/api");                
          ws.onmessage = function (msg) {
            var v = JSON.parse(msg.data)  
            if (v.tag == "update") {
              $('.upd').each(function(index){
                $(this).text(v.meta[$(this).attr('id')])
              });
              $('#title').text(v.meta.title)
              $('#artist').text(v.meta.artist)
              $('#art').attr('src', '/getimage')
              if (v.playing) {
                $('.pause').show()
                $('.play').hide()
              } else {
                $('.pause').hide()
                $('.play').show()
              }
            } else if (v.tag == "bar") {
              $('.bar').width(v.value+"%")
            }
          };                                                               
        } else {                                                             
          alert("WebSocket not supported!");                                
        }   
      });
    </script>
   
  </body>
</html>
